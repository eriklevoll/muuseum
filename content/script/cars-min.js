!function(n){var t=29,e=[0,15,16,17],r=76,s=[0,24,62,57,27,37,38,61,43,23,41,63,40,58,8,39,59,55,64],o=["events","ekspositsioon"],l=[t,r],a=[e,s],c=r-parseInt(s.length),d=t-parseInt(e.length),f=[d,c],h=(n(".cars-page-overlay"),n(".cars-page-overlay").find(".cars-body")),g=(n(".cars-page-overlay").find(".cars-side"),n(".cars-page-overlay").find("ul")),u=n("section.cars-content"),v=u.find(".expo-list"),p=1,m=0,y=0,C=function(t){var e=h.children();e.html("");var r=e.filter(function(){return"none"!==n(this).css("display")}).length;y=r;var s=o[t],c=l[t],d=a[t];for(i=0;i<r;i++)e.eq(i).css({width:100/r+"%"});for(i=1;i<c;i++)-1==jQuery.inArray(i,d)&&n("<img/>",{src:"/content/images/"+s+"/"+i+".JPG",click:function(){n(window).width()<=750||(w(),T(n(this).eq(0).attr("src")),n(this).eq(0).addClass("lightfilter"))}}).appendTo(e.eq((i-1)%r))},w=function(){h.find("img").removeClass("lightfilter"),h.find("img").removeClass("darkfilter"),v.removeClass("highlight-li")},T=function(n){var t=n.split("").reverse(),e="";for(i=0;i<t.length&&"/"!=t[i];i++)e+=t[i];e=e.split("").reverse().join("").slice(0,-4);var r=g.find("#"+e);if(0!=r.length){r.addClass("highlight-li");var s=r.position().top,o=g.scrollTop();g.animate({scrollTop:s+o-85},300)}},q=function(){var t=h.children(),e=t.filter(function(){return"none"!==n(this).css("display")}).length,r=[0,0,0,0,0],s=0,o=100/e,l=0;for(i=0;i<e;i++)s+=t.eq(i).height();for(l=s/e,i=0;i<e;i++)r[i]=l/t.eq(i).height()*o;for(i=0;i<e;i++)t.eq(i).css({width:r[i]+"%"})},k=function(i){m=0,h.find("img").load(function(){m++,m>=i&&q()})};v.on("click",function(){var i=n(this).attr("id"),t=i+".JPG";h.find("img").addClass("darkfilter");var e=h.find("img[src$='/"+t+"']"),r=e.position().top,s=h.scrollTop();h.animate({scrollTop:r+s-85},300),e.removeClass("darkfilter"),e.addClass("lightfilter"),n(this).siblings().removeClass("highlight-li"),n(this).addClass("highlight-li")});var j=function(){var i=h.children().filter(function(){return"none"!==n(this).css("display")}).length;y!=i&&(C(p),k(f[p]))};n(document).ready(function(){C(1),k(c)});var b;n(window).on("resize",function(){clearTimeout(b),b=setTimeout(function(){j()},50)})}(jQuery);
