!function(n){var e=29,t=[0,15,16,17],r=76,s=[0,24,62,57,27,37,38,61,43,23,41,63,40,58,8,39,59,55,64],o=["events","ekspositsioon"],l=[e,r],a=[t,s],c=r-parseInt(s.length),f=e-parseInt(t.length),d=[f,c],h=(n(".cars-page-overlay"),n(".cars-page-overlay").find(".cars-body")),g=n(".cars-page-overlay").find("ul"),u=n("section.cars-content"),v=u.find(".expo-list"),m=1,p=0,y=0,C=function(e){var t=h.children();t.html("");var r=t.filter(function(){return"none"!==n(this).css("display")}).length;y=r;var s=o[e],c=l[e],f=a[e];for(i=0;i<r;i++)t.eq(i).css({width:100/r+"%"});for(i=1;i<c;i++)-1==jQuery.inArray(i,f)&&n("<img/>",{src:"/content/images/"+s+"/"+i+".JPG",click:function(){k(),q(n(this).eq(0).attr("src")),n(this).eq(0).addClass("lightfilter")}}).appendTo(t.eq((i-1)%r))},k=function(){h.find("img").removeClass("lightfilter"),h.find("img").removeClass("darkfilter"),v.removeClass("highlight-li")},q=function(n){var e=n.split("").reverse(),t="";for(i=0;i<e.length&&"/"!=e[i];i++)t+=e[i];t=t.split("").reverse().join("").slice(0,-4),g.find("#"+t).addClass("highlight-li")},w=function(){var e=h.children(),t=e.filter(function(){return"none"!==n(this).css("display")}).length,r=[0,0,0,0,0],s=0,o=100/t,l=0;for(i=0;i<t;i++)s+=e.eq(i).height();for(l=s/t,i=0;i<t;i++)r[i]=l/e.eq(i).height()*o;for(i=0;i<t;i++)e.eq(i).css({width:r[i]+"%"})},T=function(i){p=0,h.find("img").load(function(){p++,p>=i&&w()})};v.on("click",function(){var i=n(this).attr("id"),e=i+".JPG";h.find("img").addClass("darkfilter");var t=h.find("img[src$='/"+e+"']");t.removeClass("darkfilter"),t.addClass("lightfilter"),n(this).siblings().removeClass("highlight-li"),n(this).addClass("highlight-li")});var b=function(){var i=h.children().filter(function(){return"none"!==n(this).css("display")}).length;y!=i&&(C(m),T(d[m]))};n(document).ready(function(){C(1),T(c)});var j;n(window).on("resize",function(){clearTimeout(j),j=setTimeout(function(){b()},50)})}(jQuery);
